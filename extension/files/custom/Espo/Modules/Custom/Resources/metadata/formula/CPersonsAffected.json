{
    "beforeSaveCustomScript": "\n\nif (extraName != null) {\n    name = string\\concatenate(firstName, string\\concatenate(extraName, \" \", lastName));\n} else {\n    name = string\\concatenate(firstName,\" \", lastName);\n};\n\nif (entity\\isNew() && isThisMemberAHeadOfHousehold == true && cHouseholdId == null){\n    $householdId = record\\create(\n        \"CHousehold\", \n        \"name\", \n        string\\concatenate(\"HH - \", string\\substring(idNumber, 0, 3),string\\substring(internalID, -3))\n    );\n    cHouseholdId =  $householdId;  \n\n} else if (entity\\isAttributeChanged(isThisMemberAHeadOfHousehold) && isThisMemberAHeadOfHousehold == true && cHouseholdId == null) {\n    $householdId = record\\create(\n        \"CHousehold\", \n        \"name\", \n        string\\concatenate(\"HH - \", string\\substring(idNumber, 0, 3),string\\substring(internalID, -3))\n    );\n    cHouseholdId =  $householdId;\n};\n \n\n// $today = datetime\\now();\n\n\n\n// age = datetime\\diff($today, dateofBirth,'years');\n\n// update head of household\n// if head of household tickbox is ticked (can we do something with if changed)\n// $id = record\\findOne('HousholdMember', 'asc', ORDER, 'householdId', householdId, 'hoh', true); // check correct namings\n// record\\update('HouseholdMember', $id, 'hoh', false);\n\n\n// //calculate the age\n\n// $today = datetime\\now();\n// $DIFF = datetime\\diff($today, $PABirthday,'years');\n// age = $DIFF\n\n// // $numberOfPAs = array\\length(cPersonAffectedsIds);\n// // $numberOfMales = 0;\n// // $i = 0;\n// // $today = datetime\\now();\n\n// // while($i < $numberOfPAs) {\n// //     $PAID = array\\at(cPersonAffectedsIds, $i);\n// //     $PAGender = record\\attribute(\"CPersonAffected\", $PAID, \"gender\");\n// //     $PABirthday = record\\attribute(\"CPersonAffected\", $PAID, \"dateofBirth\");\n// //     $DIFF = datetime\\diff($today, $PABirthday,'years');\n// //     if ($PAGender == \"Male\"){\n// //         $numberOfMales = $numberOfMales+1;   \n// //     }; \n// //     $i = $i+1;\n// // };\n// // calculatedMale = $numberOfMales;\n// // age = $DIFF"
}